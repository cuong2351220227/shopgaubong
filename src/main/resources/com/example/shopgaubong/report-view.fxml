<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.shopgaubong.controller.ReportController"
            prefHeight="700" prefWidth="1000"
            stylesheets="@report-styles.css">

    <top>
        <VBox>
            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header">
                <padding>
                    <Insets top="15" right="20" bottom="15" left="20"/>
                </padding>
                <Label text="BÃO CÃO &amp; THá»NG KÃŠ">
                    <font>
                        <Font name="System Bold" size="20"/>
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="ðŸ”„ LÃ m má»›i" onAction="#handleRefresh" styleClass="btn-refresh"/>
            </HBox>
            <Separator/>

            <!-- Filter Bar -->
            <HBox alignment="CENTER_LEFT" spacing="15" styleClass="filter-bar">
                <padding>
                    <Insets top="10" right="20" bottom="10" left="20"/>
                </padding>
                <Label text="Thá»i gian:">
                    <font>
                        <Font name="System Bold" size="12"/>
                    </font>
                </Label>
                <DatePicker fx:id="dpStartDate" promptText="Tá»« ngÃ y" prefWidth="140"/>
                <Label text="Ä‘áº¿n"/>
                <DatePicker fx:id="dpEndDate" promptText="Äáº¿n ngÃ y" prefWidth="140"/>
                <Button text="Lá»c" onAction="#handleFilter" styleClass="btn-filter"/>
                <Region HBox.hgrow="ALWAYS"/>
                <ComboBox fx:id="cbTimePeriod" promptText="Chá»n ká»³" prefWidth="150"/>
            </HBox>
            <Separator/>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true">
            <VBox spacing="20">
                <padding>
                    <Insets top="20" right="20" bottom="20" left="20"/>
                </padding>

                <!-- Thá»‘ng kÃª tá»•ng quan -->
                <VBox spacing="10">
                    <Label text="Tá»”NG QUAN">
                        <font>
                            <Font name="System Bold" size="14"/>
                        </font>
                    </Label>
                    <GridPane hgap="15" vgap="15">
                        <!-- Row 1 -->
                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Doanh thu hÃ´m nay" styleClass="stat-label"/>
                            <Label fx:id="lblTodayRevenue" text="0 â‚«" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Doanh thu tuáº§n nÃ y" styleClass="stat-label"/>
                            <Label fx:id="lblWeekRevenue" text="0 â‚«" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Doanh thu thÃ¡ng nÃ y" styleClass="stat-label"/>
                            <Label fx:id="lblMonthRevenue" text="0 â‚«" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <!-- Row 2 -->
                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="ÄÆ¡n hÃ ng hÃ´m nay" styleClass="stat-label"/>
                            <Label fx:id="lblTodayOrders" text="0" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="GiÃ¡ trá»‹ TB Ä‘Æ¡n hÃ ng" styleClass="stat-label"/>
                            <Label fx:id="lblAverageOrderValue" text="0 â‚«" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <VBox spacing="5" styleClass="stat-card" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Tá»· lá»‡ hoÃ n thÃ nh" styleClass="stat-label"/>
                            <Label fx:id="lblCompletionRate" text="0%" styleClass="stat-value">
                                <font>
                                    <Font name="System Bold" size="24"/>
                                </font>
                            </Label>
                        </VBox>

                        <columnConstraints>
                            <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                            <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                            <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                        </columnConstraints>
                    </GridPane>
                </VBox>

                <!-- Charts Section -->
                <HBox spacing="20">
                    <!-- Biá»ƒu Ä‘á»“ doanh thu -->
                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="DOANH THU THEO THá»œI GIAN">
                            <font>
                                <Font name="System Bold" size="14"/>
                            </font>
                        </Label>
                        <LineChart fx:id="revenueChart" title="Doanh thu" legendVisible="false" 
                                   prefHeight="300" minHeight="300">
                            <xAxis>
                                <CategoryAxis side="BOTTOM" label="NgÃ y"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis side="LEFT" label="Doanh thu (VND)"/>
                            </yAxis>
                        </LineChart>
                    </VBox>

                    <!-- Biá»ƒu Ä‘á»“ tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng -->
                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label text="TRáº NG THÃI ÄÆ N HÃ€NG">
                            <font>
                                <Font name="System Bold" size="14"/>
                            </font>
                        </Label>
                        <PieChart fx:id="orderStatusChart" title="PhÃ¢n bá»‘ Ä‘Æ¡n hÃ ng" 
                                  legendSide="BOTTOM" prefHeight="300" minHeight="300"/>
                    </VBox>
                </HBox>

                <!-- Top sáº£n pháº©m bÃ¡n cháº¡y -->
                <VBox spacing="10">
                    <Label text="TOP 10 Sáº¢N PHáº¨M BÃN CHáº Y">
                        <font>
                            <Font name="System Bold" size="14"/>
                        </font>
                    </Label>
                    <BarChart fx:id="topProductsChart" title="Sá»‘ lÆ°á»£ng Ä‘Ã£ bÃ¡n" 
                              legendVisible="false" prefHeight="350">
                        <xAxis>
                            <CategoryAxis side="BOTTOM" label="Sáº£n pháº©m"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis side="LEFT" label="Sá»‘ lÆ°á»£ng"/>
                        </yAxis>
                    </BarChart>
                </VBox>

                <!-- Cáº£nh bÃ¡o tá»“n kho tháº¥p -->
                <VBox spacing="10">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="âš ï¸ Cáº¢NH BÃO Tá»’N KHO THáº¤P">
                            <font>
                                <Font name="System Bold" size="14"/>
                            </font>
                        </Label>
                        <Label fx:id="lblLowStockCount" text="(0 sáº£n pháº©m)" 
                               style="-fx-text-fill: #ff5252;">
                            <font>
                                <Font name="System Bold" size="12"/>
                            </font>
                        </Label>
                    </HBox>
                    <TableView fx:id="lowStockTable" prefHeight="200">
                        <columns>
                            <TableColumn fx:id="colLowStockSKU" text="SKU" prefWidth="100"/>
                            <TableColumn fx:id="colLowStockName" text="TÃªn sáº£n pháº©m" prefWidth="250"/>
                            <TableColumn fx:id="colLowStockWarehouse" text="Kho" prefWidth="150"/>
                            <TableColumn fx:id="colLowStockQuantity" text="Tá»“n kho" prefWidth="100"/>
                            <TableColumn fx:id="colLowStockReorderPoint" text="Äiá»ƒm Ä‘áº·t láº¡i" prefWidth="120"/>
                        </columns>
                        <placeholder>
                            <Label text="âœ… KhÃ´ng cÃ³ sáº£n pháº©m nÃ o tá»“n kho tháº¥p"/>
                        </placeholder>
                    </TableView>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
